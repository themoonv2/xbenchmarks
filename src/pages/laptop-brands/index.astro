---
import Layout from "../../layouts/Layout.astro";
import laptops from "../../data/laptops.json";
import { getBrand, slugify } from "../../utils/data-helpers";

// Extract unique brands with case-insensitive deduplication
const brandMap = new Map();
laptops.forEach((laptop) => {
    const brand = getBrand(laptop.name);
    const key = brand.toLowerCase();

    if (!brandMap.has(key)) {
        brandMap.set(key, brand);
    } else {
        // If we have an existing entry but the new one is all uppercase, prefer it
        // (e.g. Prefer "ASUS" over "Asus")
        const current = brandMap.get(key);
        if (brand !== current && brand === brand.toUpperCase()) {
            brandMap.set(key, brand);
        }
    }
});

const brands = Array.from(brandMap.values()).sort();
---

<Layout title="Laptop Brands - Electrical Escape">
    <h1>Laptop Brands</h1>
    <p>Select a brand to view available series and models.</p>
    <br />
    <div class="brands-container">
        {
            brands.map((brand) => {
                const brandUrl = `${import.meta.env.BASE_URL}/laptop-brands/${slugify(brand)}`;
                return (
                    <div class="brand-card">
                        <a href={brandUrl} class="logo-link">
                            <div class="logo-container">
                                <img
                                    src={`${import.meta.env.BASE_URL}/brands/${brand.toLowerCase()}-brand.png`}
                                    alt={`${brand} Logo`}
                                    loading="lazy"
                                    onerror="this.style.display='none'"
                                />
                            </div>
                        </a>
                        <div class="brand-content">
                            <h2>
                                <a href={brandUrl}>{brand}</a>
                            </h2>
                            <p>
                                Explore the latest laptops from {brand}. Find
                                the perfect model for your needs, from
                                high-performance gaming rigs to ultralight
                                business notebooks.
                            </p>
                        </div>
                    </div>
                );
            })
        }
    </div>
</Layout>

<style>
    .brands-container {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: var(--space-6);
    }

    .brand-card {
        display: flex;
        flex-direction: column;
        transition: all 0.2s ease;
        background: var(--color-bg);
        border-radius: var(--radius-md);
        border: var(--border-primary);
    }

    .brand-card:hover {
        background-color: var(--color-surface);
        text-decoration: none;
        transform: translateY(-4px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        border-color: var(--color-border-hover);
    }

    .logo-link {
        display: block;
        width: 100%;
        padding: var(--space-6) var(--space-6) 0;
    }

    .logo-container {
        width: 100%;
        aspect-ratio: 3/2;
        display: flex;
        align-items: center;
        justify-content: center;
        background: white;
        border-radius: var(--radius-sm);
        overflow: hidden;
    }

    .logo-container img {
        width: 100%;
        height: 100%;
        object-fit: contain;
        transition: transform 0.3s ease;
    }

    .brand-card:hover img {
        transform: scale(1.05);
    }

    .brand-content {
        padding: var(--space-4) var(--space-6) var(--space-6);
        text-align: center;
    }

    .brand-content h2 {
        margin: 0 0 var(--space-2);
        font-size: var(--text-lg);
    }

    .brand-content a {
        text-decoration: none;
        color: inherit;
    }

    .brand-content p {
        margin: 0;
        font-size: var(--text-sm);
    }
</style>
